{"version":3,"sources":["uni-app:///main.js","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/add-daily-report/add-daily-report.vue?e279","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/add-daily-report/add-daily-report.vue?d9dc","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/add-daily-report/add-daily-report.vue?bbde","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/add-daily-report/add-daily-report.vue?b070","uni-app:///pages/add-daily-report/add-daily-report.vue","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/add-daily-report/add-daily-report.vue?b07e","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/add-daily-report/add-daily-report.vue?1fd2"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","form","workContent","month","zixun","caozuo","remark","userInfo","showExportBtn","table","onLoad","methods","calcNum","parseFloat","calcYeJiNum","handleChange","checkTodayDailyReport","handleSubmit","uni","title","icon","str","replace","split","arr","content","messages","mask","res","obj","duration","filterTableData","el","upDate","newAr","date","curName","tablist","findMaxCount","index","count","filterData","createExcel","headers","rows","item","uniCloud","name","allYeji","allechoMoney","fileName","splitStringByNumbers","splitChineseWords","exportToExcel","url","success","console","filePath","fileType","fail"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,uBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6H;AAC7H;AACoE;AACL;AACc;;;AAG7E;AAC0K;AAC1K,gBAAgB,6KAAU;AAC1B,EAAE,sFAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,+FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,qRAEN;AACP,KAAK;AACL;AACA,aAAa,mTAEN;AACP,KAAK;AACL;AACA,aAAa,6SAEN;AACP,KAAK;AACL;AACA,aAAa,2RAEN;AACP,KAAK;AACL;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACrDA;AAAA;AAAA;AAAA;AAAgpB,CAAgB,0nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;AC4GpqB;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AArDA,mBACA,QACA,QACA,MACA,MACA,MACA,MACA,OACA,QACA,QACA,QACA,MACA,QACA,MACA,OACA,OACA,MACA,MACA,MACA,QACA,QACA,QACA,OACA,OACA,OACA,OACA,MACA,QACA,MACA,MACA,MACA,MACA,MACA,MACA,KACA;AAEA,gBACA,MACA,MACA,MACA,MACA,OACA,MACA,MACA,MACA;AACA;AACA,MACA,MACA,MACA,OACA;AAAA,eAEA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;QACAT;MACA;IACA;EACA;EACAU;EACAC;IACAC;MACA;QACA,OACAC,+BACAA;MAEA;IACA;IACAC;MACA;QACA,OACAD;MAEA;IACA;IACAE;MACA;MACA;IACA;IACAC;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBACAC;kBACAC;kBACAC;gBACA;gBAAA;cAAA;gBAIAC,6BACAC,qBACAA,yBACAA,oBACAA,uBACAC,aAEA;gBAEAC;kBAAA;gBAAA;gBACAC;gBACAC;gBAKAR;kBACAC;kBACAQ;gBACA;gBAAA;gBAAA,OAEA;cAAA;gBAAAC;gBAAA;gBAGA;gBACAC;gBACAJ;gBACAD;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEA;gBACA;gBACAN;kBACAC;kBACAC;kBACAU;gBACA;gBACAZ;gBAAA;cAAA;gBAIAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAa;MAAA;MACA;MACA;MACA;MACAP;QACAQ;QAEA;QAEA;QACA;QACA;UACA;UACA;UACAC;UACAD;QACA;QACAE;UACAC;QACA;QAEA;UACA;YACAH;YACA;UACA;QACA;;QAEA;;QAEAI;QAEAF;QAEA;UACA;YACA;UACA;QACA;QACAA;QAEA;QAEA;UACA;UACAA;UACAA;QACA;QAEA;QACA;;QAEA;QACA;UACAA;UACA,2BACAA;QACA,kCACAA;QAEA,2BACAA;QACA;;QAEA;UACA;YACA;YACAA;YAEA;YAEAA;UACA;QACA;QACA;MACA;MAEAG;QACA;MACA;MACA;;MAEA;IACA;IAEAC;MACAC;MACA;QACA;MACA;MAEA;MAEA;MACA;QACA;UACAC;UACAhB;UACAA;QACA;UACAA;UAEA;QACA;MACA;MACA;IACA;IAEAiB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;cAAA;gBAAAP;gBAEA,IACA,0CACAA,sEACA;kBACAA;gBACA;gBAAA;gBAAA,OAEA;cAAA;gBAAA;gBAAA;gBAAA,OAIA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACAQ;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBACAC;kBAAA,QACA,2BACAC,qBACAA,iBACAA,iBACAA,oBACAA,kBACAA,kDACAA,qBACA,2BACA,4BACA,GACA;gBAAA;gBAEA3B;kBACAC;gBACA;gBAAA;gBAAA;gBAAA,OAGA2B;kBACAC;kBACA/C;oBACA2C;oBACAC;oBACAnC,uCACA;sBACAuC;sBACAC;oBAAA,EACA;oBACAC;kBACA;gBACA;cAAA;gBAZAtB;gBAaA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAV;gBACAA;kBACAC;kBACAC;gBACA;cAAA;gBAEA;gBACA;gBACAF;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAiC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;IAEAC;MACA;QACA;QACAnC;UACAoC;UAAA;UACAC;YACAC;YACA;cACAA;cACAtC;gBACAuC;gBACAC;gBACAH;kBACAC;gBACA;gBACAG;kBACAH;gBACA;cACA;YACA;UACA;UACAN;UACAS;QACA;MACA;QACA;QACAzC;UACAoC;UAAA;UACAC;YACAC;YACA;cACAA;cAGA7D;gBACA8D;gBACAF;kBACAC;gBACA;gBACAN;gBACAS;cACA;YAEA;UACA;UACAT;UACAS;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACnbA;AAAA;AAAA;AAAA;AAAutC,CAAgB,ymCAAG,EAAC,C;;;;;;;;;;;ACA3uC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/add-daily-report/add-daily-report.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/add-daily-report/add-daily-report.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./add-daily-report.vue?vue&type=template&id=46746406&\"\nvar renderjs\nimport script from \"./add-daily-report.vue?vue&type=script&lang=js&\"\nexport * from \"./add-daily-report.vue?vue&type=script&lang=js&\"\nimport style0 from \"./add-daily-report.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/add-daily-report/add-daily-report.vue\"\nexport default component.exports","export * from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add-daily-report.vue?vue&type=template&id=46746406&\"","var components\ntry {\n  components = {\n    uForm: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-form/u-form\" */ \"uview-ui/components/u-form/u-form.vue\"\n      )\n    },\n    uFormItem: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-form-item/u-form-item\" */ \"uview-ui/components/u-form-item/u-form-item.vue\"\n      )\n    },\n    uTextarea: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-textarea/u-textarea\" */ \"uview-ui/components/u-textarea/u-textarea.vue\"\n      )\n    },\n    uInput: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-input/u-input\" */ \"uview-ui/components/u-input/u-input.vue\"\n      )\n    },\n    uButton: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-button/u-button\" */ \"uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add-daily-report.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add-daily-report.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"add-daily-report-container\">\n    <view class=\"bgBox\"></view>\n    <view style=\"z-index: 1; position: relative\">\n      <view class=\"topHeader\"> 添加对账单 </view>\n      <u-form :model=\"form\" ref=\"uForm\" label-position=\"top\" label-width=\"100%\">\n        <u-form-item label=\" \" prop=\"workContent\">\n          <u-textarea\n            v-model=\"form.workContent\"\n            type=\"textarea\"\n            placeholder=\"请输入工作内容\"\n            height=\"300\"\n            maxlength=\"10000\"\n            @change=\"handleChange\"\n          />\n        </u-form-item>\n        <u-form-item label=\"月份\" prop=\"workPhotos\">\n          <u-input v-model=\"form.month\" placeholder=\"请输入月份\" clearable />\n        </u-form-item>\n        <u-form-item label=\"咨询\" prop=\"workPhotos\">\n          <u-input v-model=\"form.zixun\" placeholder=\"请输入\" clearable />\n        </u-form-item>\n        <u-form-item label=\"操作\" prop=\"workPhotos\">\n          <u-input v-model=\"form.caozuo\" placeholder=\"请输入\" clearable />\n        </u-form-item>\n        <u-form-item label=\"备注\" prop=\"workPhotos\">\n          <u-input v-model=\"form.remark\" placeholder=\"请输入\" clearable />\n        </u-form-item>\n      </u-form>\n      <view\n        style=\"display: flex; justify-content: space-between; margin-top: 30px\"\n      >\n        <u-button style=\"width: 30%\" @click=\"handleSubmit\" type=\"primary\"\n          >生成</u-button\n        >\n        <u-button\n          style=\"width: 30%\"\n          v-if=\"showExportBtn\"\n          @click=\"exportToExcel(1)\"\n          type=\"success\"\n          >预览</u-button\n        >\n        <u-button\n          style=\"width: 30%\"\n          v-if=\"showExportBtn\"\n          @click=\"exportToExcel(2)\"\n          type=\"warning\"\n          >分享</u-button\n        >\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nlet shopNameArr = [\n  \"蓝提三店\",\n  \"当代护肤\",\n  \"当代\",\n  \"宛央\",\n  \"蓝提\",\n  \"芊丽\",\n  \"颜究社\",\n  \"美丽星辰\",\n  \"天香国色\",\n  \"世纪星城\",\n  \"蜜月\",\n  \"尚美佳人\",\n  \"有路\",\n  \"丝意馨\",\n  \"研究社\",\n  \"重庆\",\n  \"公司\",\n  \"七月\",\n  \"尚成美业\",\n  \"尚城美业\",\n  \"爱艺风尚\",\n  \"三只熊\",\n  \"易之序\",\n  \"丝意鑫\",\n  \"百莲凯\",\n  \"亿美\",\n  \"苗方清颜\",\n  \"娜娜\",\n  \"济南\",\n  \"初悦\",\n  \"芊俪\",\n  \"医院\",\n  \"梅园\",\n  \"润悦\",\n];\n\nlet optItems = [\n  \"颈纹\",\n  \"溶脂\",\n  \"皮秒\",\n  \"补款\",\n  \"黄金炮\",\n  \"水光\",\n  \"打版\",\n  \"补弹\",\n  \"超声炮\",\n  // \"彩虹\",\n  \"黑金\",\n  \"7d\",\n  \"抗衰\",\n  \"黄金微针\",\n];\nimport { streamAiChat } from \"@/api/index\";\nexport default {\n  data() {\n    return {\n      form: {\n        workContent: \"\",\n        month: new Date().getMonth(),\n        zixun: \"\",\n        caozuo: \"\",\n        remark: \"\",\n      },\n      userInfo: null,\n      showExportBtn: \"\",\n      table: {\n        data: [],\n      },\n    };\n  },\n  onLoad() {},\n  methods: {\n    calcNum() {\n      return this.table.data.reduce((accumulator, currentObject) => {\n        return (\n          parseFloat(accumulator || 0) +\n          parseFloat(currentObject.echoMoney || 0)\n        );\n      }, 0);\n    },\n    calcYeJiNum() {\n      return this.table.data.reduce((accumulator, currentObject) => {\n        return (\n          parseFloat(accumulator || 0) + parseFloat(currentObject.money || 0)\n        );\n      }, 0);\n    },\n    handleChange() {\n      // 输入框内容变化时触发\n      this.showExportBtn = \"\";\n    },\n    checkTodayDailyReport() {},\n    async handleSubmit() {\n      if (!this.form.workContent) {\n        uni.showToast({\n          title: \"请输入工作内容\",\n          icon: \"none\",\n        });\n        return;\n      }\n\n      let str = this.form.workContent\n        .replace(/打扮/g, \"打版\")\n        .replace(/尚成美业/g, \"尚城美业\")\n        .replace(/<p>/g, \"\")\n        .replace(/&nbsp;/g, \"\")\n        .split(\"\\n\");\n\n      // console.log(this.form.value);\n\n      let arr = str.filter(el => el);\n      let content = \"\";\n      let messages = `对比两个数据 shopNameArr=${shopNameArr},echoArr=${arr}\n\t\t\t其中echoArr可能存在错别字，请检查是否正确，并纠正。不需要其他说明直接返回一个全新的数组给我\n\n\t\t\t`;\n\n      uni.showLoading({\n        title: \"加载中\",\n        mask: true,\n      });\n\n      let res = await streamAiChat(messages, true);\n\n      try {\n        // choices[0].message.content;\n        let obj = res[1] || res[0];\n        content = obj.data.choices[0].message.content;\n        arr = JSON.parse(content);\n      } catch (e) {\n        // log(\"解析出错\", e);\n        // this.$message.error(\"解析出错\");\n        uni.showToast({\n          title: \"解析出错,重新提交一下\",\n          icon: \"none\",\n          duration: 3000,\n        });\n        uni.hideLoading();\n        return;\n      }\n\n      uni.hideLoading();\n      this.filterTableData(arr);\n    },\n\n    filterTableData(arr) {\n      let tablist = [];\n      let upDate = \"\";\n      let curName = \"\";\n      arr.forEach((el, index) => {\n        el = el.replace(\"\\n\", \"\").trim().replace(\" \", \"\");\n\n        if (!el) return;\n\n        var reg = /^\\d+?\\.\\d+/;\n        let newAr = {};\n        if (reg.test(el)) {\n          var regex = /\\d+\\.?\\d*/g;\n          let as = el.match(regex);\n          upDate = as[0];\n          el = el.replace(upDate, \"\");\n        }\n        newAr = {\n          date: upDate,\n        };\n\n        let isHasshopName = shopNameArr.filter(field => {\n          if (el.includes(field)) {\n            el = el.replace(field, \"\");\n            return field;\n          }\n        })[0];\n\n        // log(isHasshopName, el);\n\n        curName = isHasshopName || curName;\n\n        newAr.shopName = curName;\n\n        let isHasOptName = optItems.filter(field => {\n          if (el.includes(field)) {\n            return field;\n          }\n        })[0];\n        newAr.OptName = isHasOptName;\n\n        let bsAr = el.split(isHasOptName);\n\n        if (bsAr && bsAr.length == 2) {\n          let idx = bsAr[1].indexOf(\"回款\");\n          newAr.name = bsAr[0];\n          newAr.money = idx != -1 ? bsAr[1].slice(0, idx) : bsAr[1];\n        }\n\n        var c_regex = /\\d+\\.?\\d*/g;\n        var matches = el.match(c_regex);\n\n        // console.log(matches, el);\n        if (el.indexOf(\"实际\") > -1) {\n          newAr.fencheng = \"实际:\" + matches[matches.length - 1];\n          if (el.indexOf(\"回款\") > -1)\n            newAr.echoMoney = matches[matches.length - 2];\n        } else if (el.indexOf(\"回款\") > -1)\n          newAr.echoMoney = matches[matches.length - 1];\n\n        if (el.indexOf(\"售前\") > -1)\n          newAr.fencheng = (newAr.fencheng || \"\") + \"(售前)\";\n        // log(newAr, el);\n\n        if (!newAr.OptName) {\n          try {\n            let ar = this.splitStringByNumbers(el);\n            newAr.money = ar[0];\n\n            let ar2 = this.splitChineseWords(el);\n\n            newAr.name = ar2[0] && ar2[0] != \"回款\" ? ar2[0] : \"\";\n          } catch (error) {}\n        }\n        if (newAr.money) tablist.push(newAr);\n      });\n\n      tablist.sort(function (a, b) {\n        return a.date.split(\".\")[1] - b.date.split(\".\")[1];\n      });\n      // this.table.data = tablist;\n\n      this.filterData(tablist);\n    },\n\n    findMaxCount(arr, nameAttr, index) {\n      index = index || 0;\n      if (index >= arr.length) {\n        return arr;\n      }\n\n      let currentName = arr[index][nameAttr];\n\n      let count = 1;\n      for (let i = index + 1; i < arr.length; i++) {\n        if (arr[i][nameAttr] === currentName) {\n          count++;\n          arr[i][nameAttr + \"Count\"] = 0;\n          arr[index][nameAttr + \"Count\"] = count;\n        } else {\n          arr[index][nameAttr + \"Count\"] = count;\n\n          return this.findMaxCount(arr, nameAttr, i);\n        }\n      }\n      return arr;\n    },\n\n    async filterData(arr) {\n      let newAr = await this.findMaxCount(arr, \"shopName\");\n\n      if (\n        !newAr[newAr.length - 1].shopNameCount &&\n        newAr[newAr.length - 2].shopName != newAr[newAr.length - 1].shopName\n      ) {\n        newAr[newAr.length - 1].shopNameCount = 1;\n      }\n\n      this.table.data = await this.findMaxCount(newAr, \"date\");\n\n      // console.log(this.table.data);\n\n      await this.createExcel();\n    },\n\n    // 导出为Excel\n    async createExcel() {\n      const headers = [];\n      const rows = this.table.data.map(item => [\n        this.form.zixun || \"贠清\",\n        item.shopName || \"\",\n        item.date || \"\",\n        item.name || \"\",\n        item.OptName || \"\",\n        item.money || \"\",\n        item.echoMoney ? parseFloat(item.echoMoney) : \"\",\n        item.fencheng || \"\",\n        this.form.zixun || \"贠清\",\n        this.form.caozuo || \"薇薇\",\n        \"\",\n      ]);\n\n      uni.showLoading({\n        title: \"正在生成文件...\",\n      });\n\n      try {\n        const res = await uniCloud.callFunction({\n          name: \"generateXlsx\",\n          data: {\n            headers,\n            rows,\n            table: {\n              ...this.form,\n              allYeji: this.calcYeJiNum(),\n              allechoMoney: this.calcNum(),\n            },\n            fileName: `对账单_${new Date().toLocaleDateString()}.xlsx`,\n          },\n        });\n        this.showExportBtn = res.result.data.tempUrl;\n      } catch (error) {\n        uni.hideLoading();\n        uni.showToast({\n          title: \"导出失败: \" + error.message,\n          icon: \"none\",\n        });\n      }\n      // 添加导出按钮显示\n      // this.showExportBtn = true;\n      uni.hideLoading();\n    },\n\n    splitStringByNumbers(str) {\n      // 使用正则表达式匹配所有的数字\n      const matches = str.match(/\\d+/g) || [];\n      // 将匹配到的字符串数字转换为数字类型\n      return matches.map(Number);\n    },\n    splitChineseWords(str) {\n      return str.match(/[a-z|A-Z]+/g) || str.match(/[\\u4e00-\\u9fa5]+/g);\n    },\n\n    exportToExcel(type) {\n      if (type == 1) {\n        // 预览\n        uni.downloadFile({\n          url: this.showExportBtn, // 下载url\n          success(res) {\n            console.log(\"ressss\", res);\n            if (res.statusCode == 200) {\n              console.log(\"res.statusCode\", res);\n              uni.openDocument({\n                filePath: res.tempFilePath,\n                fileType: \"xlsx\",\n                success: function (ress) {\n                  console.log(\"打开文档成功\", ress);\n                },\n                fail: function (err) {\n                  console.log(\"保存失败：\", err);\n                },\n              });\n            }\n          },\n          fileName: \"excelname\",\n          fail: console.error,\n        });\n      } else {\n        let that = this;\n        uni.downloadFile({\n          url: this.showExportBtn, // 下载url\n          success(res) {\n            console.log(\"ressss\", res);\n            if (res.statusCode == 200) {\n              console.log(\"res.statusCode\", res);\n\n              // #ifdef MP-WEIXIN\n              wx.shareFileMessage({\n                filePath: res.tempFilePath,\n                success(data) {\n                  console.log(\"转发成功！！！\", data);\n                },\n                fileName: that.form.month + \"月份对账单.xlsx\",\n                fail: console.error,\n              });\n              // #endif\n            }\n          },\n          fileName: \"excelname\",\n          fail: console.error,\n        });\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.add-daily-report-container {\n  padding: 0 20px;\n\n  overflow-y: auto;\n  background-size: 100% 100%;\n  background-position: top;\n\n  .u-textarea,\n  .u-input {\n    background: rgba(255, 255, 255, 0.4) !important;\n  }\n}\n.u-form-item__body__left__content__label {\n  color: #fff !important;\n  font-weight: bold;\n}\n\n.bgBox {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  z-index: 0;\n  background-image: url(\"https://mp-a3cab514-4968-4f82-b7c2-603b875582de.cdn.bspapp.com/a2cc7cd98d1001e968f3db98574b3aeb55e79723.jpeg\");\n  height: 100vh;\n  // opacity: 0.8;\n}\n</style>\n","import mod from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add-daily-report.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./add-daily-report.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1749015409812\n      var cssReload = require(\"D:/编辑器/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}