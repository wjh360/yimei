{"version":3,"sources":["uni-app:///main.js","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/query-performance/query-performance.vue?1280","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/query-performance/query-performance.vue?a0f7","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/query-performance/query-performance.vue?7bd0","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/query-performance/query-performance.vue?325c","uni-app:///pages/query-performance/query-performance.vue","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/query-performance/query-performance.vue?20d7","webpack:///D:/project/shudaoXiong/yimeiDemo/pages/query-performance/query-performance.vue?82f5"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","thirtyDaysAgo","form","startDate","endDate","reports","page","pageSize","loadMoreStatus","userInfo","showStartPicker","showEndPicker","loading","refreshing","totalCount","totalPerformanceValue","currentPagePerformanceValue","isAdmin","exporting","computed","totalPerformance","averagePerformance","currentPagePerformance","onLoad","uni","url","methods","formatNumber","formatDate","showStartDatePicker","showEndDatePicker","onStartDateConfirm","console","onEndDateConfirm","onRefresh","handleSearch","fetchReports","uniCloud","name","userId","res","handleReportsData","showErrorToast","title","icon","loadMore","navigateToDetail","calculateTotalPerformance","calculateAveragePerformance","handleExport","success","filePath","fileName","fail"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,yBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA0I;AAC1I;AACqE;AACL;AACsC;;;AAGtG;AAC0K;AAC1K,gBAAgB,6KAAU;AAC1B,EAAE,uFAAM;AACR,EAAE,wGAAM;AACR,EAAE,iHAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,4GAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,qRAEN;AACP,KAAK;AACL;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,aAAa,6SAEN;AACP,KAAK;AACL;AACA,aAAa,2RAEN;AACP,KAAK;AACL;AACA,aAAa,uVAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AClGA;AAAA;AAAA;AAAA;AAAipB,CAAgB,2nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACqKrqB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;EACAC;IACA;IACAC;IAEA;MACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACA;IACA;MACAC;QAAAC;MAAA;MACA;IACA;IACA;IACA;EACA;EACAC;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBAAA;gBAAA,OACA;cAAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBACA;gBAAA;gBAAA;gBAAA,OAGAC;kBACAC;kBACAtC;oBACAuC;oBACAtB;oBACAd;oBACAC;oBACAE;oBACAC;kBACA;gBACA;cAAA;gBAVAiC;gBAYA;kBACA;kBACA;kBACA;kBACA;gBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAR;gBACA;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAS;MACA;QACA;QACA;QACA;QACA;MACA;QACA;MACA;MAEA;IACA;IACAC;MACAlB;QACAmB;QACAC;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;IACA;IACAC;MACAtB;QACAC;MACA;IACA;IACAsB;MACA,yBACA,oBACA;QAAA;MAAA,GACA,EACA,CACA;IACA;IACAC;MACA;MACA,cACA,oBACA;QAAA;MAAA,GACA,EACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBACA;gBAAA;gBAGAzB;kBACAmB;gBACA;gBAAA;gBAAA,OAEAN;kBACAC;kBACAtC;oBACAuC;oBACAtB;oBACAd;oBACAC;kBACA;gBACA;cAAA;gBARAoC;gBAUAhB;gBAEA;kBACAC;kBAEAD;oBACAC;oBAAA;oBACAyB;sBACAlB;sBACA;wBACAA;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;;wBAEArC;0BACAwD;0BACAD;4BACAlB;0BACA;0BACAoB;0BACAC;wBACA;wBAEArB;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;wBACA;sBACA;oBACA;;oBACAoB;oBACAC;kBACA;;kBAEA;kBACA;kBACA;kBACA;kBACA;kBACA;kBACA;kBACA;kBACA;kBACA;kBACA;kBACA;gBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEArB;gBACA;gBACAR;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACzaA;AAAA;AAAA;AAAA;AAAgvC,CAAgB,koCAAG,EAAC,C;;;;;;;;;;;ACApwC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/query-performance/query-performance.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/query-performance/query-performance.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./query-performance.vue?vue&type=template&id=9bdab844&scoped=true&\"\nvar renderjs\nimport script from \"./query-performance.vue?vue&type=script&lang=js&\"\nexport * from \"./query-performance.vue?vue&type=script&lang=js&\"\nimport style0 from \"./query-performance.vue?vue&type=style&index=0&id=9bdab844&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9bdab844\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/query-performance/query-performance.vue\"\nexport default component.exports","export * from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./query-performance.vue?vue&type=template&id=9bdab844&scoped=true&\"","var components\ntry {\n  components = {\n    uIcon: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-icon/u-icon\" */ \"uview-ui/components/u-icon/u-icon.vue\"\n      )\n    },\n    uButton: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-button/u-button\" */ \"uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n    uLoadmore: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-loadmore/u-loadmore\" */ \"uview-ui/components/u-loadmore/u-loadmore.vue\"\n      )\n    },\n    uEmpty: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-empty/u-empty\" */ \"uview-ui/components/u-empty/u-empty.vue\"\n      )\n    },\n    uDatetimePicker: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-datetime-picker/u-datetime-picker\" */ \"uview-ui/components/u-datetime-picker/u-datetime-picker.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = _vm.formatDate(_vm.form.startDate)\n  var m1 = _vm.formatDate(_vm.form.endDate)\n  var g0 = _vm.reports.length\n  var g1 = _vm.reports.length\n  var l0 =\n    g1 > 0\n      ? _vm.__map(_vm.reports, function (report, index) {\n          var $orig = _vm.__get_orig(report)\n          var m2 = _vm.formatDate(report.date)\n          var m3 = _vm.formatNumber(report.performance)\n          var m4 = report.commission\n            ? _vm.formatNumber(report.commission)\n            : null\n          var m5 = report.actual ? _vm.formatNumber(report.actual) : null\n          return {\n            $orig: $orig,\n            m2: m2,\n            m3: m3,\n            m4: m4,\n            m5: m5,\n          }\n        })\n      : null\n  var g2 = new Date().getTime()\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.showStartPicker = false\n    }\n    _vm.e1 = function ($event) {\n      _vm.showEndPicker = false\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n        m1: m1,\n        g0: g0,\n        g1: g1,\n        l0: l0,\n        g2: g2,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./query-performance.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./query-performance.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"query-performance-container\">\n    <!-- 搜索区域 -->\n    <view class=\"search-section\">\n      <view class=\"search-card\">\n        <!-- <view class=\"admin-indicator\" v-if=\"isAdmin\">管理员查询模式</view> -->\n        <view class=\"date-range\">\n          <view class=\"date-item\" @click=\"showStartDatePicker\">\n            <text class=\"date-label\">开始日期</text>\n            <view class=\"date-value\">\n              <text>{{ formatDate(form.startDate) }}</text>\n              <u-icon name=\"calendar\" size=\"24\" color=\"#4158d0\"></u-icon>\n            </view>\n          </view>\n          <view class=\"date-separator\"></view>\n          <view class=\"date-item\" @click=\"showEndDatePicker\">\n            <text class=\"date-label\">结束日期</text>\n            <view class=\"date-value\">\n              <text>{{ formatDate(form.endDate) }}</text>\n              <u-icon name=\"calendar\" size=\"24\" color=\"#4158d0\"></u-icon>\n            </view>\n          </view>\n        </view>\n        <view class=\"button-group\">\n          <u-button\n            @click=\"handleSearch\"\n            :loading=\"loading\"\n            class=\"search-btn\"\n            text=\"查询\"\n            :customStyle=\"{\n              background: 'linear-gradient(135deg, #4158d0 0%, #c850c0 100%)',\n              color: '#ffffff',\n              flex: 1,\n              marginRight: '10px',\n            }\"\n          />\n          <u-button\n            @click=\"handleExport\"\n            :loading=\"exporting\"\n            class=\"export-btn\"\n            text=\"导出\"\n            :customStyle=\"{\n              background: 'linear-gradient(135deg, #43C6AC 0%, #191654 100%)',\n              color: '#ffffff',\n              flex: 1,\n            }\"\n          />\n        </view>\n      </view>\n    </view>\n\n    <!-- 统计信息 -->\n    <view class=\"statistics-section\" v-if=\"reports.length > 0\">\n      <view class=\"stat-card\">\n        <view class=\"stat-item\" hover-class=\"hover-scale\">\n          <text class=\"stat-label\">总业绩</text>\n          <text class=\"stat-value\">¥{{ totalPerformance }}</text>\n        </view>\n        <view class=\"stat-divider\"></view>\n        <view class=\"stat-item\" hover-class=\"hover-scale\">\n          <text class=\"stat-label\">总单数</text>\n          <text class=\"stat-value\">{{ totalCount }}</text>\n        </view>\n        <view class=\"stat-divider\"></view>\n        <view class=\"stat-item\" hover-class=\"hover-scale\">\n          <text class=\"stat-label\">平均业绩</text>\n          <text class=\"stat-value\">¥{{ averagePerformance }}</text>\n        </view>\n      </view>\n      <!-- <view class=\"stat-card current-page-stat\">\n        <view class=\"stat-item\" hover-class=\"hover-scale\">\n          <text class=\"stat-label\">当前页业绩</text>\n          <text class=\"stat-value\">¥{{ currentPagePerformance }}</text>\n        </view>\n      </view> -->\n    </view>\n\n    <!-- 报表列表 -->\n    <scroll-view\n      scroll-y\n      class=\"report-list\"\n      v-if=\"reports.length > 0\"\n      @scrolltolower=\"loadMore\"\n      :refresher-enabled=\"false\"\n    >\n      <view\n        class=\"report-item\"\n        v-for=\"(report, index) in reports\"\n        :key=\"index\"\n        @click=\"navigateToDetail(report)\"\n        hover-class=\"hover-scale\"\n      >\n        <view class=\"report-header\">\n          <text class=\"report-date\">{{ formatDate(report.date) }}</text>\n          <text class=\"report-performance\"\n            >¥{{ formatNumber(report.performance) }}</text\n          >\n        </view>\n        <view class=\"report-content\">\n          <view class=\"report-info\">\n            <text class=\"store-name\">{{ report.storeName }}</text>\n            <text class=\"customer-name\">{{ report.customerName }}</text>\n            <view class=\"user-badge\" v-if=\"isAdmin && report.userName\">{{\n              report.userName\n            }}</view>\n          </view>\n          <view class=\"report-details\">\n            <text class=\"project-name\">{{\n              report.projectName || \"无项目名称\"\n            }}</text>\n            <view class=\"report-amounts\">\n              <text v-if=\"report.commission\"\n                >分成: ¥{{ formatNumber(report.commission) }}</text\n              >\n              <text v-if=\"report.actual\"\n                >实收: ¥{{ formatNumber(report.actual) }}</text\n              >\n            </view>\n          </view>\n        </view>\n      </view>\n      <u-loadmore :status=\"loadMoreStatus\" @loadmore=\"loadMore\" />\n    </scroll-view>\n\n    <!-- 空状态 -->\n    <view class=\"empty-state\" v-else>\n      <u-empty mode=\"data\" text=\"暂无业绩数据\">\n        <u-button\n          size=\"small\"\n          @click=\"handleSearch\"\n          :customStyle=\"{\n            background: 'linear-gradient(135deg, #4158d0 0%, #c850c0 100%)',\n            color: '#ffffff',\n            borderRadius: '25px',\n            fontWeight: 'bold',\n            padding: '8px 24px',\n          }\"\n          >重新加载</u-button\n        >\n      </u-empty>\n    </view>\n\n    <!-- 日期选择器 -->\n    <u-datetime-picker\n      :show=\"showStartPicker\"\n      v-model=\"form.startDate\"\n      mode=\"date\"\n      :maxDate=\"form.endDate\"\n      @confirm=\"onStartDateConfirm\"\n      @close=\"showStartPicker = false\"\n    ></u-datetime-picker>\n\n    <u-datetime-picker\n      :show=\"showEndPicker\"\n      v-model=\"form.endDate\"\n      mode=\"date\"\n      :minDate=\"form.startDate\"\n      :maxDate=\"new Date().getTime()\"\n      @confirm=\"onEndDateConfirm\"\n      @close=\"showEndPicker = false\"\n    ></u-datetime-picker>\n  </view>\n</template>\n\n<script>\nimport FormValidator from \"@/static/utils/formValidator.js\";\n\nexport default {\n  data() {\n    const thirtyDaysAgo = new Date();\n    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n    return {\n      form: {\n        startDate: thirtyDaysAgo.getTime(),\n        endDate: new Date().getTime(),\n      },\n      reports: [],\n      page: 1,\n      pageSize: 3,\n      loadMoreStatus: \"loadmore\",\n      userInfo: null,\n      showStartPicker: false,\n      showEndPicker: false,\n      loading: false,\n      refreshing: false,\n      totalCount: 0,\n      totalPerformanceValue: 0,\n      currentPagePerformanceValue: 0,\n      isAdmin: false,\n      exporting: false,\n    };\n  },\n  computed: {\n    totalPerformance() {\n      return this.formatNumber(Number(this.totalPerformanceValue) || 0);\n    },\n    averagePerformance() {\n      if (this.totalCount === 0) return \"0.00\";\n      const total = Number(this.totalPerformanceValue) || 0;\n      const count = Number(this.totalCount) || 1;\n      return this.formatNumber(total / count);\n    },\n    currentPagePerformance() {\n      return this.formatNumber(this.currentPagePerformanceValue);\n    },\n  },\n  onLoad() {\n    this.userInfo = uni.getStorageSync(\"userInfo\");\n    if (!this.userInfo) {\n      uni.redirectTo({ url: \"/pages/login/login\" });\n      return;\n    }\n    this.isAdmin = this.userInfo.isAdmin || false;\n    this.handleSearch();\n  },\n  methods: {\n    formatNumber(num) {\n      const number = Number(num) || 0;\n      return number.toFixed(2).replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n    },\n    formatDate(timestamp) {\n      const date = new Date(timestamp);\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, \"0\");\n      const day = String(date.getDate()).padStart(2, \"0\");\n      return `${year}-${month}-${day}`;\n    },\n    showStartDatePicker() {\n      this.showStartPicker = true;\n    },\n    showEndDatePicker() {\n      this.showEndPicker = true;\n    },\n    onStartDateConfirm(e) {\n      // this.form.startDate = e.value;\n      console.log(e.value);\n      this.$set(this.form, \"startDate\", e.value);\n      this.showStartPicker = false;\n      this.handleSearch();\n    },\n    onEndDateConfirm(e) {\n      this.form.endDate = e.value;\n      this.showEndPicker = false;\n      this.handleSearch();\n    },\n    async onRefresh() {\n      this.refreshing = true;\n      await this.handleSearch();\n      this.refreshing = false;\n    },\n    handleSearch() {\n      this.page = 1;\n      this.reports = [];\n      this.loadMoreStatus = \"loadmore\";\n      return this.fetchReports();\n    },\n    async fetchReports() {\n      if (this.loading) return;\n      this.loading = true;\n\n      try {\n        const res = await uniCloud.callFunction({\n          name: \"queryReports\",\n          data: {\n            userId: this.userInfo._id,\n            isAdmin: this.isAdmin,\n            startDate: this.form.startDate,\n            endDate: this.form.endDate,\n            page: this.page,\n            pageSize: this.pageSize,\n          },\n        });\n\n        if (res.result.code === 0) {\n          this.handleReportsData(res.result.data);\n          this.totalPerformanceValue = Number(res.result.totalPerformance) || 0; // 更新总计业绩值\n          this.totalCount = Number(res.result.total) || 0; // 更新总计条数\n          // Number(res.result.currentPagePerformance) || 0;\n        } else {\n          this.showErrorToast(res.result.message);\n        }\n      } catch (err) {\n        console.error(err);\n        this.showErrorToast(\"查询失败，请重试\");\n      } finally {\n        this.loading = false;\n      }\n    },\n    handleReportsData(data) {\n      if (this.page === 1) {\n        this.reports = data;\n        // 重置总计数据\n        this.totalPerformanceValue = 0;\n        this.totalCount = 0;\n      } else {\n        this.reports = [...this.reports, ...data];\n      }\n\n      this.loadMoreStatus = data.length < this.pageSize ? \"nomore\" : \"loadmore\";\n    },\n    showErrorToast(message) {\n      uni.showToast({\n        title: message,\n        icon: \"none\",\n      });\n    },\n    loadMore() {\n      if (this.loadMoreStatus === \"loadmore\" && !this.loading) {\n        this.page++;\n        this.fetchReports();\n      }\n    },\n    navigateToDetail(report) {\n      uni.navigateTo({\n        url: `/pages/edit-report/edit-report?id=${report._id}`,\n      });\n    },\n    calculateTotalPerformance() {\n      return this.formatNumber(\n        this.reports.reduce(\n          (sum, report) => sum + (Number(report.performance) || 0),\n          0\n        )\n      );\n    },\n    calculateAveragePerformance() {\n      if (this.reports.length === 0) return \"0.00\";\n      const average =\n        this.reports.reduce(\n          (sum, report) => sum + (Number(report.performance) || 0),\n          0\n        ) / this.reports.length;\n      return this.formatNumber(average);\n    },\n    async handleExport() {\n      if (this.exporting) return;\n      this.exporting = true;\n\n      try {\n        uni.showLoading({\n          title: \"正在导出...\",\n        });\n\n        const res = await uniCloud.callFunction({\n          name: \"exportReports\",\n          data: {\n            userId: this.userInfo._id,\n            isAdmin: this.isAdmin,\n            startDate: this.form.startDate,\n            endDate: this.form.endDate,\n          },\n        });\n\n        uni.hideLoading();\n\n        if (res.result.code === 0) {\n          const url = res.result.data.url;\n\n          uni.downloadFile({\n            url: url, // 下载url\n            success(res) {\n              console.log(\"ressss\", res);\n              if (res.statusCode == 200) {\n                console.log(\"res.statusCode\", res);\n                // uni.openDocument({\n                //   filePath: res.tempFilePath,\n                //   fileType: \"xlsx\",\n                //   success: function (ress) {\n                //     console.log(\"打开文档成功\", ress);\n                //   },\n                //   fail: function (err) {\n                //     console.log(\"保存失败：\", err);\n                //   },\n                // });\n                // #ifdef MP-WEIXIN\n                wx.shareFileMessage({\n                  filePath: res.tempFilePath,\n                  success(data) {\n                    console.log(\"转发成功！！！\", data);\n                  },\n                  fileName: \"自定义文件名字.xlsx\",\n                  fail: console.error,\n                });\n                // #endif\n                console.log(wx);\n                // that.openFileEvs(res)\n                // wx.shareFileMessage({\n                //   filePath: res.tempFilePath,\n                //   success(data) {\n                //     console.log(\"转发成功！！！\", data);\n                //   },\n                //   fileName: \"自定义文件名字.xlsx\",\n                //   fail: console.error,\n                // });\n              }\n            },\n            fileName: \"excelname\",\n            fail: console.error,\n          });\n\n          // 复制链接到剪贴板\n          // uni.setClipboardData({\n          //   data: url,\n          //   success: () => {\n          //     uni.showModal({\n          //       title: \"导出成功\",\n          //       content: \"下载链接已复制到剪贴板，请在浏览器中打开下载。\",\n          //       confirmText: \"知道了\",\n          //       showCancel: false,\n          //     });\n          //   },\n          // });\n        } else {\n          this.showErrorToast(res.result.message);\n        }\n      } catch (err) {\n        console.error(err);\n        this.showErrorToast(\"导出失败，请重试\");\n        uni.hideLoading();\n      } finally {\n        this.exporting = false;\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n// 引入全局样式变量\n@import \"@/static/styles/global.scss\";\n\n.query-performance-container {\n  min-height: 100vh;\n  background-color: $background-color;\n  display: flex;\n  flex-direction: column;\n}\n\n.admin-indicator {\n  background-color: #4caf50;\n  color: white;\n  padding: 5px 10px;\n  border-radius: 4px;\n  font-size: 12px;\n  text-align: center;\n  margin-bottom: 10px;\n}\n\n.search-section {\n  background: linear-gradient(135deg, #4158d0 0%, #c850c0 100%);\n  position: sticky;\n  top: 0;\n  z-index: 100;\n  padding: 20px;\n}\n\n.search-card {\n  background: rgba(255, 255, 255, 0.8);\n  border-radius: 16px;\n  border: 1px solid rgba(238, 238, 238, 0.8);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n  padding: 20px;\n  animation: fadeIn 0.3s ease-in-out;\n}\n\n.date-range {\n  display: flex;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.statistics-section {\n  position: sticky;\n  top: 160px; // Adjust this value based on the height of your search section\n  z-index: 99;\n  padding: 10px 20px;\n  background-color: $background-color;\n\n  .current-page-stat {\n    margin-top: 10px;\n    background: linear-gradient(135deg, #4158d0 0%, #c850c0 100%);\n\n    .stat-item {\n      .stat-label,\n      .stat-value {\n        color: #ffffff;\n      }\n    }\n  }\n}\n\n.date-item {\n  flex: 1;\n  transition: transform 0.2s ease;\n\n  &:active {\n    transform: scale(0.98);\n  }\n\n  .date-label {\n    font-size: 14px;\n    color: #666666;\n    margin-bottom: 8px;\n    display: block;\n  }\n\n  .date-value {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    background-color: rgba(241, 245, 249, 0.8);\n    padding: 12px 16px;\n    border-radius: 12px;\n    border: 1px solid rgba(238, 238, 238, 0.8);\n\n    text {\n      font-size: 14px;\n      color: #333333;\n    }\n  }\n}\n\n.date-separator {\n  width: 20px;\n  height: 2px;\n  background-color: rgba(238, 238, 238, 0.8);\n  margin: 0 16px;\n  margin-top: 20px;\n}\n\n.button-group {\n  display: flex;\n  justify-content: space-between;\n}\n\n.search-btn,\n.export-btn {\n  height: 44px;\n  border-radius: 25px;\n  font-weight: bold;\n  box-shadow: 0 4px 8px rgba(72, 84, 208, 0.25);\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\n\n  &:active {\n    transform: scale(0.98);\n    box-shadow: 0 2px 4px rgba(72, 84, 208, 0.25);\n  }\n}\n\n.statistics-section {\n  padding: 20px;\n  animation: fadeIn 0.3s ease-in-out;\n}\n\n.stat-card {\n  background: rgba(255, 255, 255, 0.8);\n  border-radius: 16px;\n  border: 1px solid rgba(238, 238, 238, 0.8);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n  padding: 24px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.stat-item {\n  flex: 1;\n  text-align: center;\n  transition: transform 0.2s ease;\n\n  &:active {\n    transform: scale(0.98);\n  }\n\n  .stat-label {\n    font-size: 14px;\n    color: #666666;\n    margin-bottom: 8px;\n    display: block;\n  }\n\n  .stat-value {\n    font-size: 20px;\n    background: linear-gradient(135deg, #4158d0 0%, #c850c0 100%);\n    -webkit-background-clip: text;\n    color: transparent;\n    font-weight: bold;\n  }\n}\n\n.stat-divider {\n  width: 1px;\n  height: 40px;\n  background: linear-gradient(to bottom, transparent, #eee, transparent);\n}\n\n.report-list {\n  flex: 1;\n  padding: 0 20px;\n}\n\n.report-item {\n  background: rgba(255, 255, 255, 0.8);\n  border-radius: 16px;\n  border: 1px solid rgba(238, 238, 238, 0.8);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n  padding: 20px;\n  margin-bottom: 16px;\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\n  animation: scaleIn 0.3s ease-in-out;\n\n  &:active {\n    transform: scale(0.98);\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);\n  }\n\n  .report-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n\n    .report-date {\n      font-size: 14px;\n      color: #666666;\n    }\n\n    .report-performance {\n      font-size: 20px;\n      background: linear-gradient(135deg, #4158d0 0%, #c850c0 100%);\n      -webkit-background-clip: text;\n      color: transparent;\n      font-weight: bold;\n    }\n  }\n\n  .report-content {\n    .report-info {\n      display: flex;\n      align-items: center;\n      margin-bottom: 12px;\n\n      .store-name {\n        font-size: 16px;\n        color: #333333;\n        margin-right: 16px;\n        font-weight: 500;\n      }\n\n      .customer-name {\n        font-size: 14px;\n        color: #666666;\n      }\n\n      .user-badge {\n        margin-left: auto;\n        background-color: #4158d0;\n        color: white;\n        padding: 2px 8px;\n        border-radius: 12px;\n        font-size: 12px;\n      }\n    }\n\n    .report-details {\n      .project-name {\n        font-size: 14px;\n        color: #999999;\n        margin-bottom: 8px;\n      }\n\n      .report-amounts {\n        display: flex;\n        gap: 20px;\n\n        text {\n          font-size: 14px;\n          color: #666666;\n        }\n      }\n    }\n  }\n}\n\n.empty-state {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 0;\n  animation: fadeIn 0.3s ease-in-out;\n}\n\n// 动画效果\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes scaleIn {\n  from {\n    transform: scale(0.9);\n    opacity: 0;\n  }\n  to {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n\n// 响应式设计\n@media screen and (max-width: 375px) {\n  .search-section,\n  .statistics-section,\n  .report-list {\n    padding: 12px;\n  }\n\n  .search-card,\n  .stat-card,\n  .report-item {\n    padding: 16px;\n  }\n\n  .stat-item .stat-value {\n    font-size: 18px;\n  }\n\n  .report-item .report-header .report-performance {\n    font-size: 18px;\n  }\n}\n</style>\n","import mod from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./query-performance.vue?vue&type=style&index=0&id=9bdab844&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../编辑器/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./query-performance.vue?vue&type=style&index=0&id=9bdab844&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1748665142996\n      var cssReload = require(\"D:/编辑器/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}