(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-edit-report-edit-report"],{2728:function(t,e,a){var r=a("7885");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var o=a("967d").default;o("054582f0",r,!0,{sourceMap:!1,shadowMode:!1})},"3f2b":function(t,e,a){"use strict";(function(t){a("6a54");var r=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(a("9b1b"));a("64aa"),a("795c"),a("c223");var i=r(a("f5be")),n={data:function(){return{submitting:!1,form:{date:(new Date).getTime(),storeName:"",customerName:"",projectName:"",performance:"",commission:"",actual:"",operation:"",remark:""},rules:{storeName:[{required:!0,message:"请输入店面名称"}],customerName:[{required:!0,message:"请输入顾客名称"}],performance:[{required:!0,message:"请输入业绩金额"},{type:"number",message:"业绩必须为数字"}],commission:[{type:"number",message:"分成必须为数字"}],actual:[{type:"number",message:"实际金额必须为数字"}]},userInfo:null}},onLoad:function(t){this.userInfo=uni.getStorageSync("userInfo"),this.userInfo?t.id?this.fetchReportById(t.id):(uni.showToast({title:"缺少报表ID",icon:"none"}),setTimeout((function(){uni.navigateBack()}),1500)):uni.redirectTo({url:"/pages/login/login"})},methods:{formatDate:function(t){try{if(!t)return"";if("string"===typeof t&&isNaN(t))return t;var e=new Date(Number(t));if(isNaN(e.getTime()))return"";var a=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(o)}catch(i){return console.error("日期格式化错误:",i),""}},fetchReportById:function(e){var a=this;uni.showLoading({title:"加载数据中..."}),t.callFunction({name:"getTodayReport",data:{userId:this.userInfo._id,id:e}}).then((function(t){uni.hideLoading(),0===t.result.code&&t.result.data?(console.log("获取报表数据成功:",t.result.data),a.form=(0,o.default)((0,o.default)({},a.form),t.result.data[0])):(uni.showToast({title:t.result.message||"获取报表数据失败",icon:"none"}),setTimeout((function(){uni.navigateBack()}),1500))})).catch((function(t){console.error("获取报表数据失败:",t),uni.hideLoading(),uni.showToast({title:"获取报表数据失败",icon:"none"}),setTimeout((function(){uni.navigateBack()}),1500)}))},submitReport:function(){var e=this;this.submitting||i.default.validateAndShowError(this.form,this.rules)&&(this.submitting=!0,uni.showLoading({title:"保存中..."}),t.callFunction({name:"addReport",data:(0,o.default)({userId:this.userInfo._id},this.form)}).then((function(t){e.submitting=!1,uni.hideLoading(),0===t.result.code?(uni.showToast({title:"修改成功",icon:"success"}),setTimeout((function(){uni.navigateBack()}),1500)):uni.showToast({title:t.result.message||"修改失败",icon:"none"})})).catch((function(t){console.error("修改失败:",t),e.submitting=!1,uni.hideLoading(),uni.showToast({title:"修改失败，请重试",icon:"none"})})))}}};e.default=n}).call(this,a("861b")["default"])},7885:function(t,e,a){var r=a("c86c");e=r(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uView UI 主题变量\r\n */\r\n/**\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.page-container[data-v-7fb067fc]{min-height:100vh;background:linear-gradient(135deg,#f8f9fa,#e9ecef);padding:20px}.card[data-v-7fb067fc]{background:hsla(0,0%,100%,.7);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;border:1px solid hsla(0,0%,100%,.3);box-shadow:0 4px 20px rgba(0,0,0,.1);padding:20px;margin-bottom:20px}.gradient-button[data-v-7fb067fc]{background:linear-gradient(135deg,#4158d0,#c850c0);color:#fff;border:none;padding:12px 24px;border-radius:25px;font-weight:700;transition:all .3s ease}.gradient-button[data-v-7fb067fc]:active{-webkit-transform:translateY(2px);transform:translateY(2px)}.input-field[data-v-7fb067fc]{background-color:rgba(241,245,249,.6);border-radius:12px;padding:12px 16px;transition:all .3s ease}.input-field[data-v-7fb067fc]:hover, .input-field[data-v-7fb067fc]:focus{background-color:rgba(241,245,249,.9)}@-webkit-keyframes fadeInUp-data-v-7fb067fc{from{opacity:0;-webkit-transform:translateY(20px);transform:translateY(20px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes fadeInUp-data-v-7fb067fc{from{opacity:0;-webkit-transform:translateY(20px);transform:translateY(20px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}.animate-fade-in-up[data-v-7fb067fc]{-webkit-animation:fadeInUp-data-v-7fb067fc .5s ease-out;animation:fadeInUp-data-v-7fb067fc .5s ease-out}uni-scroll-view[data-v-7fb067fc],\r\n.report-list[data-v-7fb067fc]{width:auto!important}.u-avatar[data-v-7fb067fc]{border:none!important}.add-report-container[data-v-7fb067fc]{min-height:100vh;background:linear-gradient(135deg,#f8f9fa,#e9ecef);display:flex;flex-direction:column;position:relative;width:100%;overflow-x:hidden}.page-header[data-v-7fb067fc]{padding:20px 20px 100px;background:linear-gradient(135deg,#4158d0,#c850c0);color:#fff;border-bottom-left-radius:30px;border-bottom-right-radius:30px;box-shadow:0 4px 15px rgba(0,0,0,.1)}.page-title[data-v-7fb067fc]{font-size:24px;font-weight:700;text-shadow:1px 1px 3px rgba(0,0,0,.2)}.form-scroll[data-v-7fb067fc]{flex:1;padding:20px 0;box-sizing:border-box;width:100%;position:relative;top:-100px}.form-card[data-v-7fb067fc]{background:hsla(0,0%,100%,.7);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;border:1px solid hsla(0,0%,100%,.3);box-shadow:0 4px 20px rgba(0,0,0,.1);padding:20px;box-sizing:border-box;width:100%;-webkit-animation:fadeInUp-data-v-7fb067fc .5s ease-out;animation:fadeInUp-data-v-7fb067fc .5s ease-out;margin-bottom:30px;border-radius:20px}.date-picker[data-v-7fb067fc]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;border-radius:4px;box-shadow:0 2px 6px rgba(0,0,0,.05);border:1px solid #dadbde}.date-picker uni-text[data-v-7fb067fc]{font-size:15px;color:#333}[data-v-7fb067fc] .u-form-item{padding:5px 0;margin-bottom:0;width:100%}[data-v-7fb067fc] .u-form-item:not(:last-child){border-bottom:1px solid hsla(0,0%,93.3%,.6)}[data-v-7fb067fc] .u-form-item .u-form-item__body__left__content{font-weight:600;color:#2c3e50;font-size:16px}[data-v-7fb067fc] .u-form-item__body{padding:0;width:100%}[data-v-7fb067fc] .u-form-item__body__left{margin-bottom:0;padding-right:12px}[data-v-7fb067fc] .u-form-item__body__right{flex:1;width:0}[data-v-7fb067fc] .u-input{flex:1}[data-v-7fb067fc] .u-input .u-input__input{background-color:rgba(241,245,249,.8);border-radius:12px;padding:12px 16px;border:1px solid hsla(0,0%,93.3%,.8)}[data-v-7fb067fc] .u-input__input{width:100%;color:#2c3e50;font-size:16px}[data-v-7fb067fc] .u-input__input::-webkit-input-placeholder{color:#94a3b8}[data-v-7fb067fc] .u-input__input::placeholder{color:#94a3b8}.fixed-bottom[data-v-7fb067fc]{position:fixed;left:0;right:0;bottom:0;background-color:hsla(0,0%,100%,.9);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:16px 20px;padding-bottom:calc(16px + constant(safe-area-inset-bottom));padding-bottom:calc(16px + env(safe-area-inset-bottom));box-shadow:0 -4px 15px rgba(0,0,0,.05);z-index:999;width:100%;box-sizing:border-box;-webkit-animation:fadeInUp-data-v-7fb067fc .5s ease-out;animation:fadeInUp-data-v-7fb067fc .5s ease-out}.bottom-placeholder[data-v-7fb067fc]{height:calc(76px + constant(safe-area-inset-bottom));height:calc(76px + env(safe-area-inset-bottom));width:100%}.submit-btn[data-v-7fb067fc]{width:100%;height:50px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;background:linear-gradient(135deg,#4158d0,#c850c0);border-radius:25px;box-shadow:0 4px 8px rgba(72,84,208,.25);border:none}.submit-btn[data-v-7fb067fc]:active{-webkit-transform:translateY(2px);transform:translateY(2px);box-shadow:0 2px 4px rgba(72,84,208,.2)}[data-v-7fb067fc] .u-textarea{width:100%}[data-v-7fb067fc] .u-textarea uni-textarea{width:100%;box-sizing:border-box;background-color:rgba(241,245,249,.8);border-radius:12px;padding:12px 16px;border:1px solid hsla(0,0%,93.3%,.8)}',""]),t.exports=e},"7c13":function(t,e,a){"use strict";a.r(e);var r=a("3f2b"),o=a.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);e["default"]=o.a},"9c3d":function(t,e,a){"use strict";a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return r}));var r={uForm:a("5222").default,uFormItem:a("4e56").default,uInput:a("cc38").default,uButton:a("175e").default,uIcon:a("3c99").default},o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"add-report-container"},[a("v-uni-view",{staticClass:"page-header"},[a("v-uni-text",{staticClass:"page-title"},[t._v("编辑报表")])],1),a("v-uni-scroll-view",{staticClass:"form-scroll",attrs:{"scroll-y":!0}},[a("v-uni-view",{staticClass:"form-card"},[a("u-form",{ref:"uForm",attrs:{model:t.form,labelPosition:"left",labelWidth:"40",labelAlign:"left"}},[a("u-form-item",{attrs:{label:"日期",prop:"date"}},[a("v-uni-view",{staticClass:"date-picker"},[a("v-uni-text",[t._v(t._s(t.formatDate(t.form.date)))])],1)],1),a("u-form-item",{attrs:{label:"店面名称",prop:"storeName",required:!0}},[a("u-input",{attrs:{placeholder:"请输入店面名称"},model:{value:t.form.storeName,callback:function(e){t.$set(t.form,"storeName",e)},expression:"form.storeName"}})],1),a("u-form-item",{attrs:{label:"顾客名称",prop:"customerName",required:!0}},[a("u-input",{attrs:{placeholder:"请输入顾客名称"},model:{value:t.form.customerName,callback:function(e){t.$set(t.form,"customerName",e)},expression:"form.customerName"}})],1),a("u-form-item",{attrs:{label:"业绩",prop:"performance",required:!0}},[a("u-input",{attrs:{type:"number",placeholder:"请输入业绩金额"},model:{value:t.form.performance,callback:function(e){t.$set(t.form,"performance",e)},expression:"form.performance"}})],1),a("u-form-item",{attrs:{label:"项目名称",prop:"projectName"}},[a("u-input",{attrs:{placeholder:"请输入项目名称"},model:{value:t.form.projectName,callback:function(e){t.$set(t.form,"projectName",e)},expression:"form.projectName"}})],1),a("u-form-item",{attrs:{label:"分成",prop:"commission"}},[a("u-input",{attrs:{type:"number",placeholder:"请输入分成金额"},model:{value:t.form.commission,callback:function(e){t.$set(t.form,"commission",e)},expression:"form.commission"}})],1),a("u-form-item",{attrs:{label:"实际",prop:"actual"}},[a("u-input",{attrs:{type:"number",placeholder:"请输入实际金额"},model:{value:t.form.actual,callback:function(e){t.$set(t.form,"actual",e)},expression:"form.actual"}})],1),a("u-form-item",{attrs:{label:"操作",prop:"operation"}},[a("u-input",{attrs:{placeholder:"请输入操作信息"},model:{value:t.form.operation,callback:function(e){t.$set(t.form,"operation",e)},expression:"form.operation"}})],1),a("u-form-item",{attrs:{label:"备注",prop:"remark"}},[a("u-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1)],1),a("v-uni-view",{staticClass:"bottom-placeholder"})],1),a("v-uni-view",{staticClass:"fixed-bottom"},[a("u-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:t.submitting},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submitReport.apply(void 0,arguments)}}},[a("u-icon",{staticStyle:{"margin-right":"5px"},attrs:{name:"checkmark",size:"20"}}),t._v("保存修改")],1)],1)],1)},i=[]},b622:function(t,e,a){"use strict";var r=a("2728"),o=a.n(r);o.a},e621:function(t,e,a){"use strict";a.r(e);var r=a("9c3d"),o=a("7c13");for(var i in o)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(i);a("b622");var n=a("828b"),s=Object(n["a"])(o["default"],r["b"],r["c"],!1,null,"7fb067fc",null,!1,r["a"],void 0);e["default"]=s.exports},f5be:function(t,e,a){"use strict";a("6a54");var r=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("c223"),a("64aa"),a("5c47"),a("0506");var o=r(a("3471")),i=r(a("80b1")),n=r(a("efe5")),s=function(){function t(){(0,i.default)(this,t)}return(0,n.default)(t,null,[{key:"validate",value:function(t,e){for(var a in e)if(e.hasOwnProperty(a)){var r,i=e[a],n=(0,o.default)(i);try{for(n.s();!(r=n.n()).done;){var s=r.value;if(s.required&&(void 0===t[a]||null===t[a]||""===t[a]))return{valid:!1,field:a,message:s.message||"".concat(a,"不能为空")};if(s.min&&t[a]&&t[a].length<s.min)return{valid:!1,field:a,message:s.message||"".concat(a,"不能少于").concat(s.min,"个字符")};if(s.max&&t[a]&&t[a].length>s.max)return{valid:!1,field:a,message:s.message||"".concat(a,"不能超过").concat(s.max,"个字符")};if("number"===s.type&&t[a]&&isNaN(Number(t[a])))return{valid:!1,field:a,message:s.message||"".concat(a,"必须是数字")};if("phone"===s.type&&t[a]&&!/^1\d{10}$/.test(t[a]))return{valid:!1,field:a,message:s.message||"请输入有效的手机号码"};if("email"===s.type&&t[a]&&!/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(t[a]))return{valid:!1,field:a,message:s.message||"请输入有效的邮箱地址"};if(s.validator&&"function"===typeof s.validator){var d=s.validator(t[a],t);if(!0!==d)return{valid:!1,field:a,message:d||s.message||"".concat(a,"验证失败")}}}}catch(f){n.e(f)}finally{n.f()}}return{valid:!0}}},{key:"showError",value:function(t){uni.showToast({title:t,icon:"none",duration:2e3})}},{key:"validateAndShowError",value:function(t,e){var a=this.validate(t,e);return!!a.valid||(this.showError(a.message),!1)}}]),t}(),d=s;e.default=d}}]);